# Vulnerability Fixes Summary

## Date: 2026-01-07

### Overview
This document summarizes the status of the reported vulnerabilities and the actions taken to mitigate them.

---

## ✅ FIXED Vulnerabilities

### 1. CVE-2025-64329 - containerd/v2
- **Package**: `github.com/containerd/containerd/v2`
- **Previous Version**: v2.1.2
- **Fixed Version**: v2.1.4
- **Status**: ✅ **FIXED**
- **Action**: Updated via `go get github.com/containerd/containerd/v2@v2.1.4`

### 2. CVE-2025-31133, CVE-2025-52565, CVE-2025-52881 - runc
- **Package**: `github.com/opencontainers/runc`
- **Previous Version**: v1.2.3
- **Fixed Version**: v1.3.3
- **Status**: ✅ **FIXED**
- **CVEs Addressed**:
  - CVE-2025-31133: Container escape vulnerability
  - CVE-2025-52565: Container escape with malicious config
  - CVE-2025-52881: Container breakout vulnerability
- **Action**: Updated via `go get github.com/opencontainers/runc@v1.3.3`
- **Reference**: https://github.com/opencontainers/runc/releases

---

## ⚠️ WONTFIX / Accepted Risk

### 3. CVE-2019-25210 - Helm
- **Package**: `helm.sh/helm/v3`
- **Current Version**: v3.19.2
- **Status**: ⚠️ **WONTFIX - Design Decision**
- **Description**: Helm displays values of secrets when the `--dry-run` flag is used
- **Why Not Fixed**:
  - This is **expected behavior** by Helm maintainers, not a bug
  - When using `--dry-run`, Helm renders templates to show what would be deployed, which includes secret values
  - The Helm project has marked this as **WONTFIX** as it's considered a documentation/design issue
  - Affects **all versions** of Helm v3 - no version is immune
- **Risk Assessment**: **LOW**
  - Requires local CLI access to exploit
  - Not a remote vulnerability
  - Users explicitly requesting `--dry-run` output should expect to see rendered values
- **Recommendation**: Accept the risk and add to scanner exclusion list
- **Reference**: https://nvd.nist.gov/vuln/detail/cve-2019-25210

---

## ⚠️ PARTIALLY MITIGATED Vulnerability

### 4. CVE-2025-27144 - go-jose
- **Package**: `gopkg.in/go-jose/go-jose.v2`
- **Current Version**: v2.6.3
- **Status**: ⚠️ **TRANSITIVE DEPENDENCY - AWAITING UPSTREAM FIX**
- **Description**: DoS vulnerability in go-jose parsing (excessive memory usage)
- **Root Cause**: This is a transitive dependency pulled in by `k8s.io/apiserver@v0.34.0`
- **Mitigation Status**:
  - ✅ Direct dependencies use fixed versions:
    - `github.com/go-jose/go-jose/v3@v3.0.4` (fixes CVE-2025-27144)
    - `github.com/go-jose/go-jose/v4@v4.0.5` (fixes CVE-2025-27144)
  - ⚠️ Transitive dependency `gopkg.in/go-jose/go-jose.v2@v2.6.3` remains due to k8s.io/apiserver
- **Upstream Status**: 
  - Kubernetes is aware of this issue (see https://github.com/kubernetes/kubernetes/issues/123252)
  - Migration to go-jose v4 is in progress but not yet complete
- **Recommended Action**: 
  - Monitor Kubernetes releases for updates to k8s.io/apiserver that remove the v2 dependency
  - Consider updating k8s.io/apiserver when a version with the fix is available
  - The vulnerability has limited impact as it requires specific attack conditions

---

## Verification

### Build Status
```bash
go build ./...
```
✅ **PASSED** - All packages build successfully

### Dependency Verification
```bash
go list -m all | grep -E "helm.sh/helm|containerd/containerd/v2|opencontainers/runc|go-jose"
```

**Current Versions**:
- `github.com/containerd/containerd/v2 v2.1.2 => v2.1.4` ✅ (via replace directive)
- `github.com/go-jose/go-jose/v3 v3.0.4` ✅
- `github.com/go-jose/go-jose/v4 v4.0.5` ✅
- `github.com/opencontainers/runc v1.2.3 => v1.3.3` ✅ (via replace directive)
- `gopkg.in/go-jose/go-jose.v2 v2.6.3` ⚠️ (transitive)
- `helm.sh/helm/v3 v3.19.2` (CVE-2019-25210 is WONTFIX by upstream)

**Replace Directives Added**:
The following replace directives were added to `go.mod` to force the use of fixed versions:
```go
replace (
	google.golang.org/protobuf => google.golang.org/protobuf v1.33.0
	github.com/containerd/containerd/v2 => github.com/containerd/containerd/v2 v2.1.4
	github.com/opencontainers/runc => github.com/opencontainers/runc v1.3.3
)
```

These replace directives override the versions pulled in by `github.com/Microsoft/hcsshim` which was using the vulnerable versions.

---

## Summary

**Total Vulnerabilities**: 6 CVEs across 4 packages
- **Fixed**: 4 CVEs (67%) - containerd, runc (3 CVEs)
- **WONTFIX/Accepted**: 1 CVE (17%) - Helm CVE-2019-25210 (design decision)
- **Awaiting Upstream Fix**: 1 CVE (17%) - go-jose v2

**Risk Assessment**:
- **High Priority Fixes**: All completed ✅
  - Container escape vulnerabilities (runc) - FIXED
  - Containerd vulnerability - FIXED
- **Accepted Risk**:
  - Helm CVE-2019-25210 - WONTFIX by upstream, low severity, not exploitable remotely
- **Low Priority**: 1 remaining
  - go-jose DoS (transitive dependency, limited impact) - Awaiting upstream fix

**Next Steps**:
1. Monitor k8s.io/apiserver releases for go-jose v4 migration
2. Update k8s.io/apiserver when a fixed version is available
3. Continue monitoring security advisories for all dependencies
4. Add CVE-2019-25210 to scanner exclusion list with documented rationale

